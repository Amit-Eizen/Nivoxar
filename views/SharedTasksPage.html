<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shared Tasks - Nivoxar</title>
    <link rel="stylesheet" href="../public/styles/globals.css">
    <link rel="stylesheet" href="../public/styles/SharedTasksPage.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../public/styles/navbar.css">
</head>
<body>
    <!-- Navbar Container -->
    <div id="navbarContainer"></div>

    <!-- Shared Tasks Content -->
    <div class="shared-tasks-container">
        <!-- Main Container -->
        <div class="main-container">
            <!-- Header -->
            <header class="page-header">
                <div class="header-left">
                    <h1 class="page-title">
                        <i class="fas fa-share-nodes"></i>
                        Shared Tasks
                    </h1>
                    <p class="page-subtitle">
                        Collaborate with friends and family
                    </p>
                </div>
                <div class="header-actions">
                    <button class="header-btn notification-btn" id="notificationBtn" aria-label="Notifications">
                        <i class="fas fa-bell"></i>
                        <span class="notification-badge" id="notificationCount">0</span>
                    </button>
                </div>
            </header>

            <!-- Loading State -->
            <div id="loadingState" class="loading-state" style="display: none;">
                <div class="loading-spinner"></div>
                <p>Loading shared tasks...</p>
            </div>

            <!-- Error Message -->
            <div id="errorMessage" class="error-message" style="display: none;">
                <i class="fas fa-exclamation-circle"></i>
                <p id="errorText">An error occurred</p>
                <button class="error-close" id="errorClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <!-- Stats Section -->
            <section class="stats-section">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-share-nodes"></i>
                    </div>
                    <div class="stat-info">
                        <span class="stat-value" id="totalSharedTasks">0</span>
                        <p class="stat-label">Shared Tasks</p>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-crown"></i>
                    </div>
                    <div class="stat-info">
                        <span class="stat-value" id="ownedTasks">0</span>
                        <p class="stat-label">Tasks I Own</p>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-info">
                        <span class="stat-value" id="participatingTasks">0</span>
                        <p class="stat-label">Participating In</p>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-user-group"></i>
                    </div>
                    <div class="stat-info">
                        <span class="stat-value" id="totalCollaborators">0</span>
                        <p class="stat-label">Collaborators</p>
                    </div>
                </div>
            </section>

            <!-- Filter & Search Section -->
            <section class="controls-section">
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" id="searchInput" placeholder="Search shared tasks...">
                </div>

                <div class="filter-buttons">
                    <button class="filter-btn active" data-filter="all">
                        <i class="fas fa-th"></i>
                        All Tasks
                    </button>
                    <button class="filter-btn" data-filter="owned">
                        <i class="fas fa-crown"></i>
                        My Tasks
                    </button>
                    <button class="filter-btn" data-filter="participating">
                        <i class="fas fa-users"></i>
                        Participating
                    </button>
                </div>
            </section>

            <!-- Shared Tasks List -->
            <section class="tasks-section">
                <div id="sharedTasksList" class="tasks-list">
                    <!-- Tasks will be rendered here -->
                </div>

                <!-- Empty State -->
                <div id="emptyState" class="empty-state" style="display: none;">
                    <i class="fas fa-share-nodes"></i>
                    <h3>No Shared Tasks Yet</h3>
                    <p>Share tasks from your Dashboard to collaborate with friends and family</p>
                    <a href="/views/DashboardPage.html" class="btn btn-primary">
                        <i class="fas fa-home"></i>
                        Go to Dashboard
                    </a>
                </div>
            </section>
        </div>
    </div>

    <!-- Task Details Modal -->
    <div id="taskDetailsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTaskTitle">Task Details</h2>
                <button class="modal-close" id="closeTaskModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <!-- Task Info -->
                <div class="task-info-section">
                    <div class="info-row">
                        <label><i class="fas fa-user"></i> Owner:</label>
                        <span id="taskOwner"></span>
                    </div>
                    <div class="info-row">
                        <label><i class="fas fa-folder"></i> Category:</label>
                        <span id="taskCategory"></span>
                    </div>
                    <div class="info-row">
                        <label><i class="fas fa-flag"></i> Priority:</label>
                        <span id="taskPriority"></span>
                    </div>
                    <div class="info-row">
                        <label><i class="fas fa-calendar"></i> Due Date:</label>
                        <span id="taskDueDate"></span>
                    </div>
                    <div class="info-row">
                        <label><i class="fas fa-clock"></i> Last Edited:</label>
                        <span id="taskLastEdited"></span>
                    </div>
                </div>

                <!-- Description -->
                <div class="description-section">
                    <h3><i class="fas fa-align-left"></i> Description</h3>
                    <p id="taskDescription">No description</p>
                </div>

                <!-- Subtasks -->
                <div class="subtasks-section">
                    <h3><i class="fas fa-list-check"></i> Subtasks</h3>
                    <div id="taskSubtasks">
                        <p class="text-muted">No subtasks</p>
                    </div>
                </div>

                <!-- Collaborators -->
                <div class="collaborators-section">
                    <h3>
                        <i class="fas fa-users"></i>
                        Collaborators
                        <span class="collaborator-count" id="collaboratorCount">0</span>
                    </h3>
                    <div id="collaboratorsList" class="collaborators-list">
                        <!-- Collaborators will be rendered here -->
                    </div>
                </div>

                <!-- Actions -->
                <div class="modal-actions">
                    <button class="btn btn-primary" id="openTaskBtn">
                        <i class="fas fa-external-link-alt"></i>
                        Open in Dashboard
                    </button>
                    <button class="btn btn-secondary" id="manageParticipantsBtn">
                        <i class="fas fa-user-plus"></i>
                        Manage Participants
                    </button>
                    <button class="btn btn-danger" id="leaveTaskBtn" style="display: none;">
                        <i class="fas fa-sign-out-alt"></i>
                        Leave Task
                    </button>
                    <button class="btn btn-danger" id="unshareTaskBtn" style="display: none;">
                        <i class="fas fa-trash"></i>
                        Unshare Task
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Manage Participants Modal -->
    <div id="manageParticipantsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-users"></i> Manage Participants</h2>
                <button class="modal-close" id="closeManageModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <!-- Current Participants -->
                <div class="current-participants">
                    <h3>Current Participants</h3>
                    <div id="currentParticipantsList" class="participants-list">
                        <!-- Participants will be rendered here -->
                    </div>
                </div>

                <!-- Add Participants -->
                <div class="add-participants-section">
                    <h3>Add Participants</h3>
                    <div class="add-participant-form">
                        <select id="friendsSelect" class="form-control">
                            <option value="">Select a friend...</option>
                        </select>
                        <button class="btn btn-primary" id="addParticipantBtn">
                            <i class="fas fa-plus"></i>
                            Add
                        </button>
                    </div>
                    <p class="text-muted small">You can only add friends to shared tasks</p>
                </div>
            </div>
        </div>
    </div>

    <script type="module" src="../scripts/SharedTasksPage.js"></script>
</body>
</html>
